<!DOCTYPE html>
<html>
  <head>
    <title>Simple Node App</title>
  </head>
  <body>
    <!-- Hello World! if connected to the backend -->
    <h1 id="msg"></h1>

    <!-- Registration Form -->
    <h2>Register</h2>
    <form id="registerForm">
      <input
        type="text"
        id="username"
        placeholder="Username"
        required
      /><br /><br />
      <input
        type="password"
        id="password"
        placeholder="Password"
        required
      /><br /><br />
      <button type="submit">Register</button>
    </form>

    <p id="registerMsg"></p>
    <script>
      //backend call to index.js
      //will dispaly hello world if succesfful backend connection
      fetch("http://localhost:3000/api/hello")
        .then((res) => res.json())
        .then((data) => {
          document.getElementById("msg").innerText = data.message;
        })
        .catch(() => {
          document.getElementById("msg").innerText =
            "Error connecting to backend";
        });

      //registraation form submission request to backend
      document
        .getElementById("registerForm")
        .addEventListener("submit", function (e) {
          e.preventDefault(); // prevent page refresh

          const username = document.getElementById("username").value;
          const password = document.getElementById("password").value;

          fetch("http://localhost:3000/api/register", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username, password }),
          })
            .then((res) => res.json())
            .then((data) => {
              document.getElementById("registerMsg").innerText =
                data.message || data.error;
            })
            .catch(() => {
              document.getElementById("registerMsg").innerText =
                "Error registering user";
            });
        });
    </script>
  </body>
</html>
